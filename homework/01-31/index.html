<!DOCTYPE html>
<html>
    <head>
        <meta charset=”utf-8” />
        <title>D3 and JavaScript Libraries</title>

        <!-- Loads external CSS stylesheet -->
        <link rel="stylesheet" href="style31.css">

        <!-- Loads an external JS file -->
        <!-- Note: you must replace src with your own path -->
        <script src="/homework/01-31/scripts/myFunctions.js"></script>

        <!-- Loads the D3.js library v7 -->
        <script src="https://d3js.org/d3.v7.min.js"></script>
    </head>

    <body>
        <div>
            <h1 id="HL">JS Libraries, <br> D3.js and Data Manipulation</br></h1>
        </div>

        <p>This is an example</p>
        <p>of using</p>
        <p>d3.selectAll() on multiple p tags</p>

        <!-- Uses the function defined in myFunctions.js -->
        <script>
            console.log("The sum is: " + sumAB(1, 2));
        </script>

        <!-- Constructs five SVG circle elements -->
        <!-- <div> -->
            <!-- <svg width="760" height="200"> -->
                <!-- SVG viewport outline -->
                <!-- <rect width="760" height="200" style="fill:white;stroke-width:1;stroke:black"/> -->

                <!-- <g transform="translate(70, 70)"> -->
                    <!-- <circle/> -->
                    <!-- <circle cx = "120"/> -->
                    <!-- <circle cx = "240"/> -->
                    <!-- <circle cx = "360"/> -->
                    <!-- <circle cx = "480"/> -->
                <!-- </g> -->
            <!-- </svg> -->
        <!-- </div> -->

        <!-- Basic D3.js functions: Selections, Changing attributes and styles, Mult-Selection -->
        <script>
            // Element selector that uses "id", analogous to document.getElementByID()
            var page_title = d3.select("#HL");
            
            // Changing individual element styles

            // page_title.style("color", "blue");
            // page_title.style("font-size", "60px");

            // Chaining styles one after the other

            // page_title.style("color", "blue").style("background-color", "powderblue").style("font-size", "60px");

            // Changing element attributes

            // NOTE: You can also chain .attr with .style, one after the other like above

            // Here we assign a new class to the h1 tag (see style31.css file)
            // See documentation for tag specific attributes: https://www.tutorialrepublic.com/html-reference/html-headings-tag.php
            // and global attributes: https://www.tutorialrepublic.com/html-reference/html5-global-attributes.php

            // page_title.attr("class", "comicText");

            // Multi-Selection: Select multiple elements on a page and
            // change all of their properties at the same time using the
            // d3.selectAll() function.

            // NOTE: Please see this nice summary https://bost.ocks.org/mike/selection/

            d3.selectAll("p").style("text-align", "center").attr("class", "comicText");

            // SHOW: .style("margin-top", "80px") it applies to all and increases the inbetween gap

            // Multi-Selection and chaining on SVG elements (see above for the SVG circles)

            // Notice the syntax below. You don't have to put everything in the same line
            // as long as the semantics are in place, i.e., you use the dot notation properly.

            // d3.selectAll("circle")
            //     .style("fill", "orange")
            //     .attr("cy", "40")
            //     .attr("r", "40");
            
            // Adding user interaction on SVG elements using .selectAll()

            // d3.selectAll("circle")
            //     .style("fill", "orange")
            //     .attr("cy", "40")
            //     .attr("r", "40")
            //     .on("click", function(e, d) {
            //         d3.select(this).style("fill", "red");
            //     });
        </script>

        <!-- D3.js for animations: data arrays, enter/update/exit -->

        <div>
            <svg width="200" height="200" id="circle-viz">
                <!-- SVG viewport outline -->
                <!-- <rect width="760" height="200" style="fill:white;stroke-width:1;stroke:black"/> -->

                <!-- <g transform="translate(70, 70)"> -->
                    <!-- <circle/> -->
                    <!-- <circle cx = "120"/> -->
                    <!-- <circle cx = "240"/> -->
                    <!-- <circle cx = "360"/> -->
                    <!-- <circle cx = "480"/> -->
                <!-- </g> -->
            </svg>
        </div>

        <div>
            <button onclick="drawCircles(data1)">Data 1</button>
            <button onclick="drawCircles(data2)">Data 2</button>
            <button onclick="drawCircles(data3)">Data 3</button>
        </div>

        <script>

            // Data Arrays: a sequence of JavaScript objects written in a JSON-style format
            // JavaScript Objects; https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects

            var data1 = [
                {
                    country: "usa",
                    value: 12412341
                },
                {
                    country: "mxn",
                    value: 24123410
                }
            ];

            var data2 = [
                {
                    country: "chn",
                    value: 32412341
                },
                {
                    country: "mxn",
                    value: 24123410
                }
            ];

            var data3 = [
                {
                    country: "chn",
                    value: 65432343
                },
                {
                    country: "mxn",
                    value: 12343241
                },
                {
                    country: "usa",
                    value: 25342566
                }
            ];

            function drawCircles(dataArray) {

                var circles = d3.select("#circle-viz").selectAll("circle")
                                .data(dataArray, function(d) {
                                    return d.country;
                                });
                
                // Entering Circles
                circles.enter().append("circle")
                       .attr("fill", function(d) {
                            if (d.country == "usa") {
                                return "blue";
                            }
                            else if (d.country == "mxn") {
                                return "green";
                            }
                            else if (d.country == "chn") {
                                return "red";
                            }
                        })
                        .attr("id", function(d) {
                            return d.country;
                        })
                        .attr("cy", "100")
                        .attr("cx", randomPosition)
                        .attr("r", "0")
                        .transition().duration(1000)
                        .attr("r", "25");
                
                // Updating Circles
                circles
                    .transition().duration(1000)
                    .attr("cx", randomPosition);

                // Exiting Circles
                circles.exit()
                       .transition().duration(1000)
                       .attr("r", "0")
                       .remove();
            }

        </script>
    </body>

</html>